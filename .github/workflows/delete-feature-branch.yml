name: Delete feature branch from S3

on:
  pull_request:
    types: [ closed ]

jobs:
  deploy:
    runs-on: ubuntu-latest
    if: startsWith(github.head_ref, 'feature-') == true
    steps:
      - name: Inject slug/short variables
        uses: rlespinasse/github-slug-action@v3.x
      - name: Remove from S3
        uses: vitorsgomes/s3-rm-action@master
        with:
          args: --recursive
        env:
          AWS_S3_BUCKET: open-sdg-feature
          AWS_ACCESS_KEY_ID: ${{ secrets.AWS_ACCESS }}
          AWS_SECRET_ACCESS_KEY: ${{ secrets.AWS_SECRET }}
          PATH_TO_DELETE: ${{ env.GITHUB_HEAD_REF_SLUG }}
